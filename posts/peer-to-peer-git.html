<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/syntax.css><title>Matthew's Blag | Peer to Peer Git</title></head><body><header><h1><a href=/>Matthew B. Gray</a></h1></header><nav class=sidebar-nav><a href=/ title class=sidebar-nav-item>About Me</a>
<a href=/posts.html title class=sidebar-nav-item>Posts</a></nav><div id=content><h1>Peer to Peer Git</h1><p>Published <time datetime=2017-03-31>March 31, 2017</time>
<a href=/tags/git.html>#git</a>
<a href=/tags/offline.html>#offline</a></p><p>Sometimes your central git repository goes down, but you need to share code. That&rsquo;s a bummer, you can commit and wait, but you&rsquo;ve likely heard that you shouldn&rsquo;t need to rely on a central repo.</p><p>So you&rsquo;ve got a few options here:</p><ol><li>Mirror your repo someplace else and switch upstreams during outages,</li><li>email your stuff as patches using <a href=https://git-scm.com/docs/git-am target=_blank rel=noopener>git am</a>
,</li><li>setup a small read only local git server and pull between neighbours,</li><li>or use some kind of highly available decentralised storage as an upstream like <a href=https://github.com/larsks/git-remote-ipfs target=_blank rel=noopener>ipfs git</a>
.</li></ol><p>I feel the easiest thing to do is just to run that read only git option #3. And it&rsquo;s not that hard either, you just need a git alias to run in a shell, and your neighbour to configure and pull from you.</p><h2 id=setting-up-your-repo><a class=anchor href=#setting-up-your-repo>#</a>
Setting up your repo</h2><p>Firstly, create a &lsquo;serve&rsquo; alias for your user so you can share your work&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git config --global alias.serve <span class=s2>&#34;daemon --verbose --export-all --base-path=.git --reuseaddr --strict-paths .git/&#34;</span>
</span></span></code></pre></div><p>Now navigate to your repo and run it in the foreground&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$MY_REPO</span>
</span></span><span class=line><span class=cl>git serve
</span></span></code></pre></div><p>This should say &ldquo;Ready to rumble&rdquo; followed by log when people connect to you. When you want to shut it down, just it &ldquo;Control C&rdquo; and it&rsquo;ll kill the git server.</p><h2 id=connecting-to-your-neighbour><a class=anchor href=#connecting-to-your-neighbour>#</a>
Connecting to your neighbour</h2><p>Assuming you&rsquo;ve setup your server, you&rsquo;re now going to want to know your IP address or hostname so you can tell other people who to connect to.</p><p>To do this on OSX or Mac (sorry Windows), run ipconfig from a shell and pick your IP out. Usually this is a 192.168.x.x or a 10.x.x.x style network. Usually on Linux that&rsquo;ll be next to a device called wlan0 or eth0, and on OSX en0. If you have a machine name, that can sometimes work to! Just run <code>hostname</code> and note the output.</p><p>From henceforth, I&rsquo;m going to write <code>$YOUR_BOX</code> to represent this thing we just looked up. Just sub in whatever you got from the above.</p><p>Righty ho! Now that you have that, lets get your neighbour connected to <code>$YOUR_BOX</code>! Lets add you to your neighbours remotes&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git remote add neighbour git://<span class=nv>$YOUR_BOX</span>/
</span></span><span class=line><span class=cl>git fetch neighbour
</span></span></code></pre></div><p>Boom! Now lets set that branch as an upstream!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git checkout master
</span></span><span class=line><span class=cl>git branch --set-upstream neighbour
</span></span></code></pre></div><p>If you run a server, and so does your neighbour, the you can pull in each others changes and keep working.</p></div><footer><p><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/3.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png></a></p><p>This work is licensed under a
<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/3.0/>Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.</p></footer><script>console.log("Hello world")</script></body></html>